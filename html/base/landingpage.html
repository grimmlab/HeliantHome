{% extends "base.html" %}

{% block title %} HeliantHOME{% endblock title %}

{% block content %}
<div class="parallax">
<div class="mask" style="background-color: rgba(0, 0, 0, 0.4);height: 100%">
      <div class="d-flex justify-content-center align-items-center h-100 m-3">
        <div class="text-white">
          <h1 class="header mb-3">HeliantHOME</h1>
          <h4 class="mb-3">HeliantHOME: a public and centralized database Home of a comprehensive collection of phenotypes for different Sunflower species</h4>
          <a class="btn btn-outline-light btn-lg" href="#!" id="start_tour" role="button">Guided Tour</a>
      </div>
    </div>
  </div>
  </div>



<div class="container mt-4 container-fluid">
<div class="row">

<div class="col-sm-12 col-md-4 pt-2">
    <div class="card h-100" id="stats">
      <div class="card-header">
        Summary Statistics
      </div>
      <div class="card-body">
             <span style="white-space:nowrap" class="fs-5"><i class="bi bi-flower3 text-success fs-3 me-3"></i>{{ number_species }} Taxa
             <a href="/species/"><i class="bi bi-box-arrow-right text-black fs-3 float-end me-auto"></i></a></span>
             <br>
             <span style="white-space:nowrap" class="fs-5"><i class="bi bi-flower2 text-warning fs-3 me-3"></i>{{ number_cultivated }} Cultivated Species
             <a href="/species/"><i class="bi bi-box-arrow-right text-black fs-3 float-end me-auto"></i></a></span>
             <br>
             <span style="white-space:nowrap" class="fs-5"><i class="bi bi-globe text-primary fs-3 me-3"></i>{{ number_populations }} Populations
             <a href="/populations/"><i class="bi bi-box-arrow-right text-black fs-3 float-end me-auto"></i></a></span>
             <br>
             <span style="white-space:nowrap" class="fs-5"><i class="bi bi-person fs-3 me-3"></i>{{ number_individuals }} Individuals
             <a href="/individuals/"><i class="bi bi-box-arrow-right text-black fs-3 float-end me-auto"></i></a></span>
             <br>
             <span style="white-space:nowrap" class="fs-5"><i class="bi bi-person-square fs-3 me-3"></i>{{ number_accessions }} Accessions
             <a href="/accessions/"><i class="bi bi-box-arrow-right text-black fs-3 float-end me-auto"></i></a></span>
             <br>
             <span style="white-space:nowrap" class="fs-5"><i class="bi bi-rulers text-secondary fs-3 me-3"></i>{{ number_phenotypes }} Phenotypes
             <a href="/phenotypes"><i id="phenotype_detail" class="bi bi-box-arrow-right text-black fs-3 float-end me-auto"></i></a></span>
             <br>
             <span style="white-space:nowrap" class="fs-5"><i class="bi bi-sort-numeric-down text-secondary fs-3 me-3"></i>{{ number_measurements }} Measurements
             <a href="/phenotypes"><i class="bi bi-box-arrow-right text-black fs-3 float-end me-auto"></i></a></span>
             <br>
             <span style="white-space:nowrap" class="fs-5"><i class="bi bi-images text-danger fs-3 me-3"></i>{{ number_images }} Images
             <a href="/images/"><i class="bi bi-box-arrow-right text-black fs-3 float-end me-auto"></i></a></span>
             <br>
      </div>
    </div>
</div>


<div class="col-sm-12 col-md-4 pt-2">
    <div class="card h-100" id="phenotype">
      <div class="card-header">
        Phenotype Categories
      </div>
      <div class="card-body">
            <canvas id="phenotype_doughnut"></canvas>
      </div>
    </div>
</div>
<div class="col-sm-12 col-md-4 pt-2">
    <div class="card h-100" id="popmap">
      <div class="card-header">
        Population Map
      </div>
      <div class="card-body mh-100" id="world-map" style="height:300px">
      </div>
    </div>
</div>
</div>

<div class="row mt-2">

<div class="col-sm-12 col-md-2 pt-2">
    <div id="carouselExampleIndicators" class="carousel carousel-dark slide" data-bs-ride="carousel">
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="3" aria-label="Slide 4"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="4" aria-label="Slide 5"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="5" aria-label="Slide 6"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="6" aria-label="Slide 7"></button>
      </div>
      <div class="carousel-inner" style="max-height: 400px;min-width: auto;">
        <div class="carousel-item active">
          <img src="/media/images/slider/im1.jpg" class="d-block mx-auto" style="max-height: 400px;min-width:auto">
        </div>
        <div class="carousel-item">
          <img src="/media/images/slider/im2.jpg" class="d-block mx-auto"  style="max-height: 400px;min-width:auto">
        </div>
        <div class="carousel-item">
          <img src="/media/images/slider/im3.jpg" class="d-block mx-auto"  style="max-height: 400px;min-width:auto">
        </div>
        <div class="carousel-item">
          <img src="/media/images/slider/im4.jpg" class="d-block mx-auto"  style="max-height: 400px;min-width:auto" >
        </div>
        <div class="carousel-item">
          <img src="/media/images/slider/im5.jpg" class="d-block mx-auto"  style="max-height: 400px;min-width:auto">
        </div>
        <div class="carousel-item">
          <img src="/media/images/slider/im6.jpg" class="d-block mx-auto"  style="max-height: 400px;min-width:auto">
        </div>
        <div class="carousel-item">
          <img src="/media/images/slider/im7.jpg" class="d-block mx-auto"  style="max-height: 400px;min-width:auto">
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
</div>

<div class="col-sm-12 col-md-7 pt-2">
    <span class="fw-light lh-sm" style="font-size:10.5pt">The genus <em>Helianthus</em> (commonly known as sunflower) is large and diverse, and includes more than 50 wild species, most of them native of North America. We have selected a handful of them, for an in-depth study of genetic, phenotypic and environmental variation and local adaptation, based on their relative major abundance and ability to grow in a variety of, often extreme, environments, including deserts, salt marshes and serpentine soils (<span style="white-space:nowrap"><a class="mr-2 text-decoration-none"  href="https://doi.org/10.1038/s41586-020-2467-6" target="_blank">Todesco et al., Nature 2020  <i class="bi bi-box-arrow-up-right fs-6"></i></a></span>). These data has established the bases for the construction of HeliantHOME.<br><br>
    In addition, the cultivated sunflower (<em>Helianthus annuus var. macrocarpus</em>) is one of the main crops worldwide and therefore of great agricultural relevance. For this reason, we have also included them here as an invaluable source of data and knowledge.
    The study of sunflowers can offer numerous possibilities both to increase our understanding of ecological and evolutionary processes as well as to contribute to the development of genetic research and breeding efforts (<span style="white-space:nowrap"><a href="https://doi.org/10.1111/1755-0998.12023" target="_blank" class="text-decoration-none">Kane et al., Mol Ecol Resour 2013 <i class="bi bi-box-arrow-up-right fs-6"></i></a></span>).<br><br>
    The current availability of a well curated, reference genome for the cultivated Sunflower (<span style="white-space:nowrap"><a href="https://sunflowergenome.org/" target="_blank" class="text-decoration-none">https://sunflowergenomes.org <i class="bi bi-box-arrow-up-right fs-6"></i></a></span>) has now made it possible to start asking new types of questions about sunflower ecology and its evolutionary history. It also opens the possibility to investigate the genetic association between sequence and gene function in a more accurate way. HeliantHOME offers the perfect platform from where to start that journey.</span>
</div>
<div class="col-sm-12 col-md-3 pt-2">
                    <figure class="figure">
                     <img src="/static/img/phylotree.png" class="figure-img img-fluid rounded-3" alt="Phylogenetic Tree" style="max-height:320px">
                     <figcaption class="figure-caption" style="font-size:8pt">Phylogenetic Tree 
                        <span style="white-space:nowrap"><a class="mr-2 text-decoration-none"  href="https://doi.org/10.1038/s41586-020-2467-6" target="_blank">Todesco et al., Nature 2020  <i class="bi bi-box-arrow-up-right fs-6"></i></a></span>
                     <!--<span style="white-space:nowrap"><a href="https://doi.org/10.3732/ajb.1500031" target="_blank" class="text-decoration-none">Stephens et al., American Journal of Botany 2015 <i class="bi bi-box-arrow-up-right fs-6"></i></a></span>-->
                     </figcaption>
                    </figure>
</div>
</div>
</div>

<script>
    $(function(){
        var cat_string = "{{category_list}}".replaceAll("&quot;",'"');
        var categories = JSON.parse(cat_string);
        const ctx = document.getElementById('phenotype_doughnut').getContext('2d');
        const chart = new Chart(ctx, {
          type: 'doughnut',
          data: {
            labels: categories,
            datasets: [{
              label: 'Phenotypes',
              data: {{category_entries}},
              backgroundColor: ['rgb(0, 66, 157)', 
                                'rgb(86, 129, 185)', 
                                'rgb(147, 196, 210)', 
                                'rgb(255, 255, 224)', 
                                'rgb(255, 165, 158)', 
                                'rgb(221, 76, 101)', 
                                'rgb(147, 0, 58)',
                                '#fa8231','#8854d0'],
              hoverOffset: 4,
            },
            ]
          },
          options: {
            responsive: true,
            aspectRatio: {% if request.user_agent.is_mobile %} 1 {% else %} 1 {% endif %},
            plugins: {
                legend: {
                    display: true,
                    position: "bottom",
                }
            }
          }
        });

        $('#world-map').vectorMap({map: 'us_aea', backgroundColor: "", 
            regionStyle: {
                initial: {
                    fill: '#999999'
                },
            },
            scaleColors: ['#C8EEFF', '#0071A4'],
            normalizeFunction: 'polynomial',
            hoverOpacity: 0.7,
            hoverColor: false,
            markerStyle: {
                initial: {
                    fill: '#F8E23B',
                    stroke: '#383f47'
                }
            },
            markers: {{ map_data|safe }}
        });
    });

    $('#start_tour').click(function() {
        var steps = [
            {
                element: '.header',
                intro: 'HeliantHOME is a public and centralized database Home of a comprehensive collection of phenotypes for different Sunflower species. This tour will show some of the main features'
            },
            {
                element: '#faq_button',
                intro: 'The FAQ section provides additional information about features of HeliantHOME'
            },
            {
                element: '#download_button',
                intro: 'Download center for downloading data batchwise from HeliantHOME'
            },
            {
                element: '#phenotype',
                intro: 'Summary of different phenotype categories and how much phenotypes are available for which categorie'
            },
            {
                element: '#popmap',
                intro: 'Population maps shows locations of wild sunflowers which are integrated into this database'
            },
            {
                element: '#stats',
                intro: 'Short summary statistics about the database content, e.g. the number of phenotypes or images included in the database.'
            },
            {
                element: '#phenotype_detail',
                intro: 'Clicking on one of these buttons forwards you to additional information, e.g. like here to an overview about all integrated phenotypes'
            },

        ];
        var intro = introJs();
        intro.setOptions({doneLabel:'Next page',steps:steps});
        intro.start().oncomplete(function() {
          window.location.href = 'phenotypes/?multipage=true';
        });
        //.onexit(function() {
        //  ga('send', 'event', 'Tour', 'exit','Home');
        //});
    });
</script>





{% endblock content %}
